# Customer_segmentation_RFM_analysis_project

## Table of contents
- [Ask](#Ask)

## Project Overview 

Welcome to our Customer Segmentation project focused on RFM (Recency, Frequency, Monetary) Analysis. This project emphasizes the importance of data-driven decision-making for refining business strategies.
Our main goal is to provide businesses with deeper insights into their customer base, allowing them to optimize marketing strategies and drive sustained growth. We believe that the insights gained from this analysis will be invaluable for informed strategic decision-making.

---

# `Ask`

### Business Problem Statement

In the rapidly evolving business environment, gaining a deep understanding of customer behavior is a key differentiator for success. Companies are constantly seeking answers to questions such as: Who are our highest value customers? How can we enhance customer loyalty? How can we optimize our marketing efforts for better returns?

This project is aimed to tackle these pressing business issues by implementing a Customer Segmentation model based on RFM (Recency, Frequency, Monetary) Analysis. The objective is to classify customers into distinct segments based on their purchasing patterns, which can then guide targeted and effective marketing strategies.

By applying the RFM model, businesses can identify their most profitable customers, comprehend the buying behavior of different customer segments, and customize their marketing and sales strategies accordingly. This could lead to improved customer retention, enhanced customer lifetime value, and ultimately, increased profitability.

The challenge is in accurately analyzing and interpreting the data, and converting these insights into actionable business strategies. This is where our project steps in. Harnessing the capabilities of Microsoft SQL Server and Tableau, we aim to equip businesses with the necessary tools to make informed decisions and stay competitive in the market.

#### Guiding Questions for our analysis

- What is the total Revenue generated by the Products?
- what are the monthly sales by the country?
- which country is the highest contributer in revenue?
- which year bussiness was the strongest?
- Who are our highest value customers?
- How can we enhance customer loyalty?
- How can we optimize our marketing efforts for better returns?

---

# `Prepare`

**Introduction to the Prepare Phase of Data Analysis**

During the Prepare phase of our data analysis journey, we lay the groundwork for extracting actionable insights from our dataset. Our dataset was meticulously collected from a github repository, it is been uploaded to my repo so you can check it out [sales_data_sample](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/blob/main/sales_data_sample.csv).

To proceed, we initiated a comprehensive data preparation process, beginning with data cleaning and preprocessing done on spreadsheets a little. This involved identifying and addressing any inconsistencies, missing values, or outliers that could potentially distort our analysis. By ensuring data integrity and reliability, we set a solid foundation for accurate and meaningful insights.

Next, we embarked on data transformation tasks to enhance the usability and interpretability of our dataset. Throughout the Prepare phase, we maintained a systematic approach, documenting our procedures and decisions to ensure reproducibility and transparency. By adhering to best practices in data preparation, we set the stage for robust analysis and informed decision-making in the subsequent phases of our project.

we went ahead and opened it in **Excel** to get a sense of the raw data and how it could be of our use.

---

# `Process`

### Tools Used

- Microsoft Excel :- Basic cleaning and trimming
- Microsoft SQL Server :- 90 % of analysis was done with this including **RFM** techniques, filtering & sorting, Data Validation etc.
- Tableau :- Data visualisation.

### Data Source

As Explained above in the preparation phase. The data for our analysis is primarily collected from a Github repository. The data initially was very dirty.
it is **SALES DATA** of a global company that sells variour types of products including vehicles.

### Data cleaning using **Excel** and a little bit **MS-SQL Server**
- Duplicate rows were deleted.
- Trimming was done to leading and trailing spaces.
- Unwanted columns were removed.  
- Standardizing of rows using **UPPER**, **LEN**, **SUBSTRING**, **LOWER** functions in SQL


### Data Extraction

From this Data source we applied a lot of SQL Queries to get the data needed 

#### Checking Unique Values

1. Status of orders that exist
``` SQL
select distinct status from [dbo].[sales_data_sample]
```
Result:

![Screenshot 2024-02-11 162642](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/7c284b31-e1e7-47e0-bc82-266fee7c32b6)

2. Years for which Data is available
``` SQL
select distinct year_id from [dbo].[sales_data_sample]
```
Result:

![Screenshot 2024-02-11 164341](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/dd3a379b-bd76-4707-b4d2-20d2a9c999a2)

3. Products that the company sells
``` SQL
select distinct PRODUCTLINE from [dbo].[sales_data_sample]
```
Result:

![Screenshot 2024-02-11 164408](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/5f9983e8-0df0-489c-ac81-68ee19ce2ea6)

4. Countries in which business runs
``` SQL
select distinct COUNTRY from [dbo].[sales_data_sample]
```
Result: 

![Screenshot 2024-02-11 164508](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/293f5710-7368-48f2-ae6d-b47238bfea6b)

5. Dealsizes
```SQL
select distinct DEALSIZE from [dbo].[sales_data_sample]
```
Result:

![Screenshot 2024-02-11 164609](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/134b41bc-63a3-4370-927d-17008e455864)

6. Territories
```SQL
select distinct TERRITORY from [dbo].[sales_data_sample]
```
Result:

![Screenshot 2024-02-11 164634](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/a0cdaaa0-dac9-4c06-ad95-c375d92d3f6e)

---

# `Analyse`

### 1. Revenue by Product Line
``` SQL
select PRODUCTLINE, Sum(sales) as Revenue
from [dbo].[sales_data_sample] 
group by PRODUCTLINE
order by 2 desc;
```
Result:

![Screenshot 2024-02-11 165334](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/41527bbb-8102-462c-a5ff-4840532b7e23)

### 2. Using Aggregate Functions Revenue of **Sales by Year**
```SQL
select YEAR_ID, Sum(sales) as Revenue
from [dbo].[sales_data_sample] 
group by YEAR_ID
order by 2 desc;
```
Result:

![Screenshot 2024-02-11 165606](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/cc3996be-d0f9-4674-8576-8995facd31ec)

### A. Since the revenue was relatively low in 2005 so we went ahead and checked further whether they operated for the full year or not in 2005.

```SQL
select distinct MONTH_ID from [dbo].[sales_data_sample]
where YEAR_ID = 2005;
```
Ressult:

![Screenshot 2024-02-11 165853](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/06a6405e-2341-4149-8f10-3850fce6d9e6)


### we found that they operated for only 5 months in 2005, hence the low revenue.

### B. Checking for the months of operation in the year 2003 and 2004
``` SQL
select distinct MONTH_ID from [dbo].[sales_data_sample]
where YEAR_ID = 2003 ---change the year to 2004 to get the result
order by MONTH_ID
```
Result:

![Screenshot 2024-02-11 170056](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/ded78261-29ea-4f18-8feb-978967388ddf)

### Result shows that they were in operation for the whole year, in the year 2003 and 2004, hence relatively greater revenue.

### 3. Revenue By the DealSize
``` SQL
select DEALSIZE, Sum(sales) as Revenue
from [dbo].[sales_data_sample] 
group by DEALSIZE
order by 2 desc;
```
Result: 

![Screenshot 2024-02-11 170915](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/109e1bd6-e210-4920-a106-0035a3b6f70b)

### 4. Revenue and No. of Sales By Months in a particular year
```SQL
SELECT 
    CASE MONTH_ID
        WHEN 1 THEN 'January'
        WHEN 2 THEN 'February'
        WHEN 3 THEN 'March'
        WHEN 4 THEN 'April'
        WHEN 5 THEN 'May'
        WHEN 6 THEN 'June'
        WHEN 7 THEN 'July'
        WHEN 8 THEN 'August'
        WHEN 9 THEN 'September'
        WHEN 10 THEN 'October'
        WHEN 11 THEN 'November'
        WHEN 12 THEN 'December'
    END AS Month_Name,
    SUM(sales) AS Revenue,
    COUNT(ORDERNUMBER) AS Frequency
FROM [dbo].[sales_data_sample]
WHERE YEAR_ID = 2003 -- you can change this to see for other years
GROUP BY MONTH_ID
ORDER BY 2 DESC;
```

Result:

![Screenshot 2024-02-11 175055](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/c9f97a71-3924-4e4f-8475-43fc75a4f382)

### We ran the query for both the years 2003 and 2004 and found out that **November** was the best month and generated the highest revenue in both the years.

### 5. Best selling product for 2003 and 2004
```SQL
select 

 CASE MONTH_ID
        WHEN 1 THEN 'January'
        WHEN 2 THEN 'February'
        WHEN 3 THEN 'March'
        WHEN 4 THEN 'April'
        WHEN 5 THEN 'May'
        WHEN 6 THEN 'June'
        WHEN 7 THEN 'July'
        WHEN 8 THEN 'August'
        WHEN 9 THEN 'September'
        WHEN 10 THEN 'October'
        WHEN 11 THEN 'November'
        WHEN 12 THEN 'December'
    END AS Month_Name,
 PRODUCTLINE, SUM(sales) as Revenue, Count (ORDERNUMBER) AS Frequency
from [dbo].[sales_data_sample]
where YEAR_ID = 2003 and MONTH_ID = 11 --- we can change thiis to see for the rest of the years
group by MONTH_ID, PRODUCTLINE      
order by 3 desc;
--- we had to add the PRODUCTLINE in the groupby as it is not a part of the aggregate function.

```
Result: 

![Screenshot 2024-02-11 184536](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/6eb9c6a7-6a3a-46d4-a099-42307ab6e78e)

### 6. Highest sales in a Specific Country
``` SQL
select city, sum (sales) Revenue
from [dbo].[sales_data_sample]
where country = 'UK' --- we can change the country as per our requirement
group by city
order by 2 desc;
```
Result:

![Screenshot 2024-02-18 153214](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/103256b5-dd58-4642-b5c1-a17882d1c9f4)

### 7. Best product in a specific country
``` SQL
select country, YEAR_ID, PRODUCTLINE, sum(sales) Revenue
from [dbo].[sales_data_sample]
where country = 'USA'
group by  country, YEAR_ID, PRODUCTLINE
order by 4 desc
```
Result:

![Screenshot 2024-02-18 153433](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/2e115238-79ff-48c0-bc02-cf2f4469b60e)


# RFM Analysis 

RFM analysis is a powerful technique used in customer segmentation to categorize customers based on their transactional behavior. It involves analyzing three key metrics:

1. Recency (R): How recently a customer has made a purchase.
2. Frequency (F): How often a customer makes purchases.
3. Monetary Value (M): How much money a customer spends on purchases.


### In order to use the RFM technique we made a table that has Recency (How recent the customer had last purchaesd?). we created a table which had last order date in the daabase along the last order date of the customer

### we used 
```SQL
[max(ORDERDATE) AS last_order_date]
```
and 
``` SQL
select max(ORDERDATE) from [dbo].[sales_data_sample]
```
as the ultimate last date the company had an order.

we went ahead and used the DATEIFF functun to find the Recency of the customer
``` SQL
select 
CUSTOMERNAME,
sum(sales) as Total_Monetary_value,
avg(sales) as Average_Monetary_value,
COUNT(ORDERNUMBER) as Frequency,
max(ORDERDATE) AS last_order_date,
(select max(ORDERDATE)  from [dbo].[sales_data_sample]) as max_order_date,
DATEDIFF(DD, max(ORDERDATE), (select max(ORDERDATE)  from [dbo].[sales_data_sample])) as Recency
from [dbo].[sales_data_sample]
group by CUSTOMERNAME
```
![Screenshot 2024-02-11 201044](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/2e3fb515-a1c6-43e9-be28-1d9c78b8984b)

These are a few out of a long list.

### We Got the Recency and these numbers indicate the days out of 365.

## The smaller the number the more recent the customer has purchased a product from the company and is termed as a **`Recent customer`**.

# Customer Segmentation

### we dont stop here we go ahead and build on this code to segment our customers. we use NTILE function in the SQL to segment our data into tiles or buckets of equal values.
```SQL
select r.*,
	NTILE(4) over (order by Recency desc) as rfm_recency,
	NTILE(4) over (order by Frequency) as rfm_frequency,
	NTILE(4) over (order by Total_Monetary_value) as rfm_monetary
from rfm as r
```
Result: 

![Screenshot 2024-02-18 150128](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/24a9b8f6-9b72-4a67-8e46-6d428ee0c25e)

### After using CONCAT function on R,F,M as string values so that we get a column where the values are stacked as (111),(123) etc.

### This is our second last perfected query for customer segmentation
``` SQL
DROP TABLE IF EXISTS #rfm

; with rfm as 
(select 
	CUSTOMERNAME,
	sum(sales) as Total_Monetary_value,
	avg(sales) as Average_Monetary_value,
	COUNT(ORDERNUMBER) as Frequency,
	max(ORDERDATE) AS last_order_date,
	(select max(ORDERDATE)  from [dbo].[sales_data_sample]) as max_order_date,
	DATEDIFF(DD, max(ORDERDATE), (select max(ORDERDATE)  from [dbo].[sales_data_sample] )) as Recency
from [dbo].[sales_data_sample]
group by CUSTOMERNAME
),
rfm_calc as
(
	select r.*,
	NTILE(4) over (order by Recency desc) as rfm_recency,
	NTILE(4) over (order by Frequency) as rfm_frequency,
	NTILE(4) over (order by Total_Monetary_value) as rfm_monetary
	from rfm as r
)
select
	c.*, rfm_recency+rfm_frequency+rfm_monetary as rfm_cell,
	CAST(rfm_recency as varchar) + CAST (rfm_frequency as varchar) + CAST (rfm_monetary as varchar) as rfm_cell_string
	into #rfm
	from rfm_calc c

select * from #rfm
```

### This query returns the following Data :

![Screenshot 2024-02-18 151042](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/2fb42e23-2bff-47e1-93d4-d6181a46512a)


### Defining the variables in using CASE function to finally segment our customers
```SQL
select  
 CUSTOMERNAME , rfm_recency, rfm_frequency, rfm_monetary,
	case 
		
		when rfm_cell_string in (111, 112 , 121, 122, 123, 132,221, 211, 212, 114, 141) then 'lost_customers'  --lost customers
		when rfm_cell_string in (133, 134, 143,234, 244, 334, 343, 344, 144) then 'slipping away, cannot lose' -- (Big spenders who havenâ€™t purchased lately) slipping away
		when rfm_cell_string in (311, 411, 331, 412, 421) then 'new_customers'
		when rfm_cell_string in (222, 232, 223, 233, 322, 423) then 'potential_churners'
		when rfm_cell_string in (323, 333,321, 422, 332, 432) then 'active_customer' --(Customers who buy often & recently, but at low price points)
		when rfm_cell_string in (433, 434, 443, 444) then 'loyal_customers'
	end rfm_segment
from #rfm
```
### Final Result:

![Screenshot 2024-02-18 152034](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/e6c51482-ded7-4148-bd60-6ad1066f1d72)

### From this we can make out thr list of most loyal customers, active customers, potential churners, new customers, the big spenders who are not ordering often and are slipping away and we dont want to loose them.

## Charts Prepared using Tableau

1. Sales and Quantity Distribution

![Screenshot 2024-02-18 162438](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/a65d7c1e-900c-43fb-b105-39bf225598a6)

2. Sales Distribution by the Product Line and Year

![Screenshot 2024-02-18 161626](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/93d82807-af74-4f7c-a135-6ec4ae287f34)

3. Revenue and Monthly sales By the Country

![Screenshot 2024-02-18 161602](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/42674b34-891c-4ed8-96c2-623783561b30)

4. Customer Distribution By the Country

![Screenshot 2024-02-18 161710](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/b583b033-3f6f-4483-a147-4005dd20c9f6)

---
# `Share`
Introduction:

Welcome to the SHARE phase of our data analysis project, where we present the key insights derived from our examination of the 2003 and 2005 dataset. Through our analysis, we've uncovered valuable findings regarding revenue trends, customer behavior, and market dynamics. This phase aims to communicate these insights effectively, facilitating informed decision-making and strategic planning within our organization. 

## Key Findings
- In 2004 company mede the highest revenue of 4724162.59
- The Medium Dealsize is the category that sells the most and generates the highest revenue.
- November is the month for 2003 & 2004 in  which the sales and revenue are the maximum.
- Classic cars is the highest selling product in the whole productline for both years.
- Categorization of customers on the basis of the Recency, the freguency and the Monetry value they add to the company.
- USA is the highest contributer to the revenue.

  
## For the sharing phase of the analysis we used Tableau for making Dashboards

### 1. Revenue Analysis

![Screenshot 2024-02-18 154553](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/95589670-2dab-4d8b-b79d-e9a99a8b4959)


### 2. Sales Distribution

![Screenshot 2024-02-18 162343](https://github.com/Luckychoudharyy/Customer_segmentation_RFM_analysis_project/assets/157785333/f43d3bcf-00b5-43f5-982a-a86416d82d9c)


---

# `Act`

## Recommendations to the Stakeholders

- **Maximize Medium Dealsize Category**: 
  - Allocate resources towards promoting and expanding the Medium Dealsize category, as it demonstrates the highest sales and revenue.
  - Consider introducing new products or enhancing existing ones within this category to further drive revenue growth.

- **Strategic Marketing in November**:
  - Capitalize on the peak sales and revenue observed in November by launching targeted marketing campaigns and promotions during this period.
  - Leverage seasonal trends to drive increased customer engagement and boost sales.

- **Focus on Classic Cars**:
  - Continue to prioritize the Classic Cars product line, given its consistent performance as the highest-selling product.
  - Explore opportunities to innovate within this category to maintain its appeal to customers.

- **Customer Segmentation for Targeted Strategies**:
  - Utilize the customer segmentation based on Recency, Frequency, and Monetary value to tailor marketing strategies and promotions.
  - Implement personalized approaches to engage high-value customers and foster long-term loyalty.

- **Enhanced Engagement with USA Market**:
  - Strengthen efforts in the USA market, the highest revenue contributor, by investing in targeted marketing and customer relationship initiatives.
  - Explore partnerships or collaborations to further penetrate and expand market presence in the USA.

- **Continuous Monitoring and Adaptation**:
  - Implement regular monitoring of sales and revenue trends to identify emerging opportunities or challenges.
  - Remain agile and adaptable to market changes, adjusting strategies as necessary to maintain competitiveness and drive sustained growth.


